RUN DEBIAN_FRONTEND=noninteractive apt-get update
RUN DEBIAN_FRONTEND=noninteractive apt-get install -y \
    curl \
    ffmpeg \
    git \
    git-lfs \
    graphicsmagick \
    htop \
    iftop \
    jq \
    libx264-dev \
    nethogs \
    python3-pip \
    screen \
    stress \
    vim \
    wget

RUN wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O ~/miniconda.sh
RUN bash ~/miniconda.sh -b -p $HOME/miniconda
RUN eval "$(/$HOME/miniconda/bin/conda shell.bash hook)" && conda config --set auto_activate_base true

RUN pip3 install \
    anthropic \
    boto3 \
    botocore \
    einops \
    ftfy \
    imageio \
    matplotlib \
    numpy \
    openai \
    opencv-python \
    orjson \
    pandas \
    pillow \
    pyyaml \
    regex \
    scipy \
    tqdm \
    tornado

RUN pip3 install git+https://github.com/openai/CLIP.git

RUN pip3 install \
    diffusers["torch"] \
    ninja \
    open_clip_torch \
    torch-ema \
    torchmetrics \
    trimesh \
    pysdf \
    lpips
